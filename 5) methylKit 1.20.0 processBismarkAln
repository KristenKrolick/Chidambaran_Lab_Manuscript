#this is script for processing one sample, a script was submitted for each sample. Pathway and sample names have been replaced with simulated examples.

#!/bin/env Rscript
my.file <- file.path("Lab/data/sorted_bams/sample1_read1_val_1_bismark_bt2_pe.deduplicated.sort.bam")

library(methylKit)
objs = processBismarkAln(
  location = my.file,
  sample.id = "sample1", 
  assembly="hg38",
  save.folder="<Lab/data/sorted_bams/processbismarkaln_mincov1>",
  save.context="CpG",
  nolap=FALSE,
  mincov=1,
  minqual=20,
  phred64=FALSE,
  treatment=1)
