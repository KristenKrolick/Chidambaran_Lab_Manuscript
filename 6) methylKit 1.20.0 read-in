#files were read-in and stored as flat file databases due to memory constraints.
#Below shows only 4 samples for simplification; however, all samples with CPSP phenotype data were read in. 
#Pathway and sample names have been replaced with simulated examples.


setwd("Lab/data/sorted_bams/processbismarkaln_mincov1")
library(methylKit)

file.list <- list(
  "Lab/data/sorted_bams/processbismarkaln_mincov1/sample1_CpG.txt",
  "Lab/data/sorted_bams/processbismarkaln_mincov1/sample2_CpG.txt",
  "Lab/data/sorted_bams/processbismarkaln_mincov1/sample3_CpG.txt",
  "Lab/data/sorted_bams/processbismarkaln_mincov1/sample4_CpG.txt"
  )

myobj = methRead(
  file.list,
  sample.id = list(
    "sample1",
    "sample2",
    "sample3",
    "sample4"
  ),
  assembly = "hg18",
  treatment = c(
    1,
    0,
    0,
    1
  ),
  context = "CpG",
  dbtype = "tabix",
  dbdir = "methylDB")



