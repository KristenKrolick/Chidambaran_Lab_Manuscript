#bismark generated bam files were sorted and indexed prior to input into methylKit (two independent scripts listed below):

module load samtools/1.14.0

for file in *.bam ; do samtools sort -@18 ${file} -o ${file}.sort ; done

for file in *.sort ; do samtools index -@18 $file ; done



#afterwards I realized that I had to rename all of the files so that they ended in .sort.bam instead of .bam.sort (and same for all the corresponding .bai files as well):

for f in *.bam.sort; do
   mv -- "$f" "${f%.bam.sort}.sort.bam"
done

for f in *.bam.sort.bai; do
   mv -- "$f" "${f%.bam.sort.bai}.sort.bam.bai"
done

